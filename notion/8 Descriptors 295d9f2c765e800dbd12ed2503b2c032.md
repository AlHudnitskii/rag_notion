# 8. Descriptors

Категория: Python Core
Статус: В процессе

Дескриптор - это объектовый атрибут с поведением, определяемым методами в его классе. Если просто - это способ, с помощью которого объект может контролировать доступ к его атрибутам, используя методы `__get__`, `__set__`, и `__delete__`.

Протокол дескриптора в Python определяется наличием методов `__get__`, `__set__` и `__delete__` в классе.  Также существует необязательный метод `__set_name__`, который позволяет дескриптору узнавать имя атрибута, к которому он присвоен в классе.

Метод `__get__` вызывается, когда значение атрибута извлекается, он принимает два аргумента: `self` и `instance`. `Instance` - экземпляр объекта, который доступен через дескриптор, или `None`, если обращение идет через класс.

![image.png](image%2070.png)

`__set__` позволяет управлять изменением значения атрибута. Он принимает три аргумента: `self`, `instance` и `value`, где `value` - это новое значение атрибута.

![image.png](image%2071.png)

`__delete__` вызывается при удалении атрибута с использованием оператора `del`. Он принимает два аргумента: `self` и `instance`:

![image.png](image%2072.png)

Необязательный метод `__set_name__` вызывается в момент создания класса для каждого дескриптора. Он принимает два аргумента: `self` и `name`, где `name` - это имя атрибута:

![image.png](image%2073.png)

Пример создания дескриптора для реализации паттерна Singleton:

![image.png](image%2074.png)

**@property** работает как дескриптор, используя методы `__get__`, `__set__` и `__delete__` для управления доступом к атрибуту.

![image.png](image%2075.png)

### Разница между  __getattr__ и __getattribute__

Краткое сравнение 

![image.png](image%2076.png)

## 1. `__getattr__` - запасной вариант

### Когда вызывается

Только когда атрибут **не найден** обычным способом (не в `__dict__` (**специальный атрибут (словарь), который хранит атрибуты экземпляра объекта или класса как пары ключ-значение)**, не в классе, не у родителей).

![image.png](image%2077.png)

## 2. `__getattribute__` - перехватывает ВСЁ

### Когда вызывается

При **каждом** обращении к любому атрибуту, даже существующему.

![image.png](image%2078.png)

Существует риск рекурсии в случае, если мы обращаемся к атрибуту, поэтому необходимо обязательно вызывать родительский метод

![image.png](image%2079.png)