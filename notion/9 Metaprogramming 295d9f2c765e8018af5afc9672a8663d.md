# 9.Metaprogramming

Категория: Python Core
Статус: В процессе

Метапрограммирование в Python позволяет нам писать код, который может изменять или генерировать другой код в рантайме. Один из способ достижения этого - метаклассы, который позволяют контролировать создание и поведение классов.

Метаклассы - классы, определяющие создание других классов.  По умолчанию, каждый класс в Python экземпляр встроенного типа метакласса. 

![                                       Метакласс создает класс и класс создает объект](image%2080.png)

                                       Метакласс создает класс и класс создает объект

Для создания собственного метакласса, необходимо наследовать тип “метакласса” и переопределять методы:

1. [**__new__()](https://www.geeksforgeeks.org/python/__new__-in-python/)** - Создает объект и возвращает его. 
2. [**__init__()](https://www.geeksforgeeks.org/python/__init__-in-python/)** - Инициализирует созданный объект.

Также мы можем создать класс, используя функцию type().

![image.png](image%2081.png)

![image.png](image%2082.png)

При написании класса можно добавить атрибут __metaclass**__:** 

![image.png](image%2083.png)

Пример метакласса: 

![image.png](image%2084.png)

Основное применение метаклассов - создание API. Django ORM позволяет писать что-то такое:

![image.png](image%2085.png)

Тем не менее, если выполнить следующий код:

![image.png](image%2086.png)

мы получим не `IntegerField`, а `int`, причём значение может быть получено прямо из базы данных. Все дело в метаклассах)