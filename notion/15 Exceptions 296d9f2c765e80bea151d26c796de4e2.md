# 15. Exceptions

Категория: Python Core
Статус: В процессе

**Исключение (exception)** - это событие, которое возникает во время выполнения программы и нарушает нормальный ход ее работы. Исключения позволяют программе продолжить работу после обнаружения ошибки, а не завершиться аварийно. 

Типы ошибок в Python:

1. Синтаксические ошибки (Syntax Errors):  возникают из-за нарушения правил синтаксиса языка. Обнаруживаются на этапе компиляции.

![image.png](image%20168.png)

1. Исключения (Exceptions): возникают во время выполнения программы в зависимости от обстоятельств.

![image.png](image%20169.png)

Когда возникает исключение, Python выводит трассировку (traceback):

![image.png](image%20170.png)

Компоненты traceback:

- **Traceback (most recent call last)** — начало сообщения
- **File "main.py", line 3** — файл и номер строки
- **Название исключения** — `ZeroDivisionError`
- **Описание** — `division by zero`

В Python все исключения организованы в иерархию классов. Вершиной является `BaseException`:

![image.png](image%20171.png)

Системные исключения (не рекомендуется перехватывать):

- **SystemExit** — вызывается функцией `sys.exit()` при выходе из программы
- **KeyboardInterrupt** — прерывание программы пользователем (Ctrl+C)
- **GeneratorExit** — вызывается методом `close()` объекта-генератора

Обычные исключения (наследники Exception):

Это исключения, которые можно и нужно обрабатывать в коде.

Обработка исключений: try/except

Базовый синтаксис

![image.png](image%20172.png)

Простой пример

![image.png](image%20173.png)

![image.png](image%20174.png)

Для получения информации об исключениях используется ключевое слово `as` для получения объекта исключения:

![image.png](image%20175.png)

Можно обрабатывать разные типы исключений отдельно:

![image.png](image%20176.png)

Причем порядок блоков `except` имеет значение:

- Python проверяет блоки сверху вниз
- Более частные исключения должны быть перед общими

Для обработки нескольких исключений одинаково используется кортеж исключений:

![image.png](image%20177.png)

Блок else: выполняется, если исключений не было.

Блок finally: выполняется всегда, независимо от наличия исключений.

Применение finally:

- Закрытие файлов
- Освобождение ресурсов
- Закрытие соединений с БД
- Удаление временных файлов

Пример работы с сетевыми запросами 

![image.png](image%20178.png)

Блоки `try/except` могут быть вложенными для более гибкой обработки ошибок:

![image.png](image%20179.png)

Обработка исключений внутри функций

![image.png](image%20180.png)

Для создания пользовательского исключения нужно наследоваться от `Exception`:

![image.png](image%20181.png)

![image.png](image%20182.png)

Для вызова исключений используется ключевое слово `raise` :

![image.png](image%20183.png)

`assert` — это инструкция для отладки, которая проверяет истинность утверждения. Если условие ложно, возбуждается исключение `AssertionError`.
`assert` эквивалентен 

![image.png](image%20184.png)

Пример использования:

![image.png](image%20185.png)

Утверждения `assert` можно отключить запуском Python с флагом `-O` (оптимизация).

![image.png](image%20186.png)

Лучшие практики:

1. Перехватывайте конкретные исключения.
2. Не игнорируйте исключения молча.
3. Используйте finally для очистки ресурсов.
4. Используйте цепочку исключений (exception chaining).