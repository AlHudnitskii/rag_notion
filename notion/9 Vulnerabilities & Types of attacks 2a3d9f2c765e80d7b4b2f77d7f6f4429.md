# 9. Vulnerabilities & Types of attacks

Категория: Web & Networks
Статус: Готово

## Network attacks

### Buffer Overflow

В языках программирования, в которых необходимо следить за памятью, как C или С++, переменные представлены в операционной системе через структуру памяти, называемую стеком. Затем злоумышленник может перезаписать часть стека, называемую указателем возврата. Он определяет где именно ЦП должен выполнить следующий код. В случае, когда злоумышленник может управлять возвращаемым указателем, он может с его помощью контролировать, какие инструкции должен выполнять процессор.

Для примера возьмем код, написанный на языке С:

![image.png](image%20631.png)

Переменная name должна иметь длину не более 12 символов. Тем не менее, при попытке записи значения, превышающего ожидаемое, центральный процессор все равно попытается записать это значение в память. Это фактически приводит к тому, что центральный процессор перезаписывает другие данные в памяти, например, возвращаемый указатель, позволяющий злоумышленникам управлять центральным процессором.

Пример ниже — реакция железа на корректные и некорректные вводимые данные:

![image.png](image%20632.png)

![image.png](image%20633.png)

Проще говоря, переполнение буфера позволяет злоумышленникам получить контроль над процессором жертвы путем тщательной перезаписи памяти жертвы.

### Vulnerability Scanners (Сканеры уязвимостей)

Сканер уязвимостей автоматически выполняет поиск распространенных уязвимостей в программном обеспечении и конфигурациях по всей сети. Он не предназначен для поиска новых классов уязвимостей, а вместо этого использует список предварительно определенных плагинов (или модулей) для сканирования служб на наличие проблем и уязвимостей. 

Сканер уязвимостей часто поддерживает настройку с использованием учетных данных, что позволяет ему входить в систему и оценивать уязвимости, а не находить их без проверки подлинности.

Примечание: Сканеры уязвимостей в основном ищут известные уязвимости и неправильные конфигурации.

### Code Execution

Когда злоумышленники обнаружили уязвимость, которую они могут использовать, им необходимо решить, какую полезную нагрузку (payload) они хотят запустить. Полезная нагрузка - это код, который злоумышленник хочет получить с помощью эксплойта.

Примеры payload:

- Заставьте жертву зарегистрироваться на сервере C2, принимающем команды от злоумышленников
- Создайте новую учетную запись пользователя backdoor в системе, чтобы злоумышленник мог использовать ее позже
- Откройте GUI  вместе с жертвой, чтобы злоумышленник мог удаленно управлять ею
- Получите терминал командной строки, оболочку, через которую злоумышленник может отправлять команды

Полезной нагрузкой, часто используемой злоумышленниками, является оболочка привязки (bind shell). Это заставляет жертву прослушивать порт, и когда злоумышленник подключается, он получает оболочку.

Полезной нагрузкой, часто используемой злоумышленниками, является оболочка привязки (bind shell). Это заставляет жертву прослушивать порт, и когда злоумышленник подключается, он получает оболочку.

![image.png](image%20634.png)

*Брандмауэр ([firewall](https://www.google.com/search?client=opera&q=firewall&sourceid=opera&ie=UTF-8&oe=UTF-8&ved=2ahUKEwjM8rTIyauRAxXQHxAIHbdKOaEQgK4QegYIAQgAEAM)) — это система сетевой безопасности, которая контролирует и фильтрует входящий и исходящий трафик между доверенными и недоверенными сетями, например, между локальной сетью и интернетом.*

Брандмауэры помогают злоумышленникам не подключаться к жертвам. Брандмауэр эффективно блокирует входящие подключения к жертве до тех пор, пока порт не будет разрешен. Только одно приложение может прослушивать порт, поэтому злоумышленники не смогут прослушивать порты, которые уже используются, если только они не отключат эту службу.

Чтобы обойти эту защитную меру, злоумышленники вместо этого попытаются заставить жертву подключиться к атакующему, что позволит жертве получить доступ к полезной нагрузке. К сожалению, многие брандмауэры не настроены на блокирование исходящего трафика, что делает эту атаку очень эффективной для злоумышленников.

![image.png](image%20635.png)

Выполнение кода означает, что злоумышленники могут запускать свой код в системе жертвы. Выбор кода для развертывания зависит от них самих, но часто это связано с тем, что злоумышленники имеют возможность выполнять команды в системе жертвы в долгосрочной перспективе.

### Network Monitoring

В большинстве случаев злоумышленникам требуется сеть для удаленного управления целью. Когда злоумышленники способны удаленно управлять целью, это делается через канал управления, часто называемый C&C (Command and Control) или C2.

Обнаружение взломов часто можно выполнить, обнаружив канал C2. C2 может принимать любую форму, например:

- Для связи с серверами злоумышленников используется протокол HTTPS. Это делает C2 похожим на просмотр веб-страниц.
- Использование социальных сетей для автоматической публикации и чтения сообщений,
- Таких систем, как Google Docs, для добавления и редактирования команд жертвам.

![image.png](image%20636.png)

Для мониторинга сети следует использовать контекст, который поможет отличить шум от сигнала. Это означает, что SOC ("Центр управления безопасностью") должен попытаться дополнить данные, например IP-адреса источника и назначения, контекстом, чтобы сделать данные более ценными.

Контекст применения можно описать следующим сценарием: 

1. Атака происходит из Интернета, но она пытается использовать уязвимость Linux в отношении службы Windows. 

Обычно это расценивается как шум и может быть безопасно проигнорировано; за исключением случаев, когда IP-адрес, с которого осуществляется атака, является IP-адресом вашей собственной сети или провайдера, которому вы доверяете? 

1. Контекст, который мы можем использовать, может дать ценную информацию для дальнейшего изучения атаки. 

В конце концов, мы же не хотим, чтобы системы, которым мы доверяем, запускали какие-либо атаки!

### Peer to peer traffic

[Peer-to-peer (P2P) трафик](https://www.google.com/search?client=opera&q=Peer-to-peer+%28P2P%29+%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA&sourceid=opera&ie=UTF-8&oe=UTF-8&mstk=AUtExfDh_ZjT8GS6uCfX8UyZUrdODgkiwjjrULfIO5MBngOfyJrAAEWEilyyFqkUGKa3fOlMSf9jDsdoZdFJoscF0vWXoDVybaYGh3NpBJOxv9UW4rs1aDk_dXXuDIdesoGpJ7IdbM-CwCp4rqrHEBs9B6LHJFi_IIp4Z7pUzfQv8yyH8u_MEdtDv-kEFvbo-s-ZOGViGWmizyYrfvew90EM2rX6caz7_ZGg_CsSJ9H2T3kZAOZmsWLMvgZmAs63mBFuP-Q_Hli-DZULWKlOyGKbWBhGBXmvp_JN4mWvqHB0qrfqvw&csui=3&ved=2ahUKEwjs6Z_-yquRAxX-FRAIHRbDDc0QgK4QegQIARAB) (трафик «равный к равному») — это обмен данными или услугами напрямую между устройствами пользователей, минуя центральный сервер, где каждый участник (peer) выступает и клиентом, и сервером, что обеспечивает децентрализацию и часто повышает скорость и качество связи, как в торрентах или P2P-звонках. 

Например, порт 445, используемый SMB (Server Message Block), является хорошим индикатором для обнаружения компрометации. В большинстве сред клиенты не должны общаться друг с другом через SMB, однако во время компрометации, вероятно, злоумышленник попытается использовать SMB для дальнейшей компрометации систем.

![image.png](image%20637.png)

### **Lateral Movement and Pivoting**

Как только система скомпрометирована, злоумышленник может использовать ее для изучения дополнительных сетей, к которым у скомпрометированной системы есть доступ. Это возможно в среде, где скомпрометированная система имеет больше привилегий через брандмауэр или у системы есть доступ к другим сетям, например, через дополнительную сетевую карту.

Поворот (Pivoting) означает, что злоумышленник использует скомпрометированный хост для доступа к другим сетям. Здесь показана иллюстрация этого: Eve скомпрометировала одну систему и использует ее для сканирования и обнаружения других:

![image.png](image%20638.png)

Боковое перемещение (Lateral Movement) - это использование преимуществ pivot и использование другой системы, использующей pivot. Эта новая система теперь может использоваться для выполнения поворотов и дополнительных боковых перемещений. В этом примере Eve использует сервер X для дальнейшего изучения системы B.

![image.png](image%20639.png)

![image.png](image%20640.png)

## **Web Application Attacks**

### **IDOR ("Insecure Direct Object Reference")**

Уязвимости IDOR возникают, когда разработчики не реализовали требования авторизации для доступа к ресурсам.

![image.png](image%20641.png)

Ева, просто изменив идентификатор, например, параметр document Rest, может получить доступ к документам Алисы.

Пример кода, для которого такое может прокатить:

![image.png](image%20642.png)

Можно его улучшить, используя привилегии:

![image.png](image%20643.png)

### **Avoiding "Magic Numbers"**

Вместо первичный ключей для ресурсов like 1, 2, 3, 4, 5, нужно использовать UUID.

UUID (Universally Unique Identifier) — это 128-битное значение, стандартный способ создания универсальных уникальных идентификаторов для объектов и сущностей в компьютерных системах, который гарантирует практически нулевую вероятность совпадения, даже при генерации на разных устройствах и в разное время, без централизованного управления. Представляет собой строку символов в формате `8-4-4-4-12`, например, `a1b2c3d4-e5f6-7890-1234-567890abcdef`. 

### **SQL Injection**

SQL-инъекция - это метод, который позволяет злоумышленникам манипулировать SQL ("Языком структурированных запросов"), используемым разработчиком веб-приложения. Обычно это происходит из-за недостаточной очистки данных. SQL регулярно используется разработчиками для доступа к ресурсам базы данных.

![image.png](image%20644.png)

Такое поведение будет работать для кода ниже:

![image.png](image%20645.png)

Переменные username и password не обрабатываются; вместо этого они используются непосредственно в SQL, что приводит к возникновению уязвимости

![image.png](image%20646.png)

Параметризованные запросы - рекомендуемое решение для предотвращения SQL-инъекций. В рамках параметризованного запроса разработчики тщательно следят за тем, чтобы каждый ввод в запрос определялся как конкретное значение и тип. Вот пример из приведенного выше кода, который считается безопасной реализацией:

![image.png](image%20647.png)

### **XSS ("Cross-Site Scripting")**

XSS (Cross-Site Scripting, Межсайтовый скриптинг) — это **тип атаки на веб-сайты, при котором злоумышленник внедряет вредоносный код (обычно JavaScript) в страницы, просматриваемые другими пользователями, заставляя браузер жертвы выполнить его, как будто это часть легитимного сайта**. Это позволяет хакеру красть конфиденциальные данные (куки, токены), перехватывать сессии, перенаправлять пользователей на фишинговые ресурсы или подменять содержимое страниц, получая доступ к информации, которую браузер считает доверенной. 

![image.png](image%20648.png)

**Основные типы XSS**

- **Отраженные (Reflected XSS):** Скрипт вставляется в ссылку или запрос, и возвращается (отражается) обратно в ответе сервера к пользователю. Требует, чтобы пользователь перешел по вредоносной ссылке.
- **Хранимые (Stored XSS):** Скрипт сохраняется на сервере (например, в базе данных) и отображается всем пользователям, посещающим страницу, где он хранится (например, в комментариях).
- **DOM-based XSS:** Атака происходит полностью на стороне клиента (в браузере), где вредоносный код модифицирует DOM-дерево страницы, прежде чем она будет отрисована.

### HTML Encoding

Кодировка HTML позволяет веб-приложению безопасно возвращать обычно небезопасные символы. Например, следующие специальные символы могут быть закодированы в соответствующие им аналоги:

![image.png](image%20649.png)

### **CSP ("Content Security Policy")**

Веб-сервер может контролировать, какой тип JavaScript разрешен для запуска на веб-сайте. Это не устраняет уязвимости, но обеспечивает более глубокую защиту на случай обнаружения неизвестной уязвимости.

Общепринятый и строгий CSP заключается в предоставлении пользователям веб-приложения списка всех принятых исходных файлов JavaScript.

Кроме того, для CSP характерно предотвращение выполнения встроенного JavaScript.

Чтобы упростить внедрение и обнаружение текущих атак, CSP позволяет клиентам сообщать о нарушениях CSP по URL-адресу, предоставленному сервером

### **Web-Application Scanning**

Существует множество сканеров веб-приложений. Они позволяют проверять приложения на наличие уязвимостей, таких как SQL-инъекции и XSS. В отличие от сканера сетевых уязвимостей, сканер веб-приложений обычно основан на эвристике, а не на сигнатурах и списках известных уязвимостей.

Сканеры веб-приложений полезны, особенно если они встроены в процессы разработки, такие как CI ("Непрерывная интеграция") и CD ("Непрерывная поставка").

### **Wi-Fi Attacks**

Wifi сам по себе является протоколом IEEE 802.11 протокол. 

Беспроводная связь осуществляется обычно через AP (Access Point) - точку доступа. Peer-to-peer связь возможна также, но она не так распространена.

Беспроводную связь еще называют SSID - Service Set Identifer. 

Wifi сигналы достигают каждого, кто находится поблизости, злоумышленники могут перехватывать всю информацию, прослушивая всю информацию, которую передает отправитель.

Для WiFi характерно: 

- Отсутствие безопасности
- Список доступа, состоящий из MAC-адресов
- PSK ("Pre-Shared Key")
- Корпоративная аутентификация

Многие атаки через WiFi основаны на 2 функциях сетевых карт:

- Режим мониторинга: позволяет сетевой карте пересылать пакеты, предназначенные для всех MAC-адресов системы
- Передача пакетов: сетевая карта поддерживает создание

### Open WiFi Network

Открытая WiFi-сеть - сеть без пароля для доступа. Общение между AP и Клиентом никак не шифруется, значит, каждый шифруется индивидуально xdd. 

![image.png](image%20650.png)

Точки доступа часто могут отключать широковещательную передачу названия беспроводной сети. Для подключения к сети клиентам необходимо продемонстрировать знание SSID. Не рекомендуется включать скрытый SSID, поскольку имя сети отображается при каждом подключении клиента.

![image.png](image%20651.png)

Некоторые точки доступа поддерживают управление доступом на основе MAC-адресов. Точка доступа может создать список разрешений для MAC-адресов, которым должно быть разрешено подключаться к сети и обмениваться данными в сети.

Этот подход безопасен. Злоумышленник может прослушивать и наблюдать за другими системами, которые уже взаимодействуют по сети. Затем запишите их MAC-адреса и измените собственный MAC-адрес злоумышленника на тот, который уже разрешен. Это позволяет эффективно обойти требование фильтрации MAC-адресов.

### PSK (Pre-Shared Key)

PSK просто означает, что сеть настроена с помощью пароля. Защита PSK обычно реализуется с помощью протокола, называемого WPA ("Wi-Fi Protected Access"). Также можно использовать более старые протоколы для аутентификации, например WEP ("Wired Equivalent Privacy"), но они долгое время считались устаревшими, поскольку отличаются высокой степенью защиты и их легко взломать злоумышленникам.

WPA выпускается в различных формах, и с 2021 года последним стандартом является WPA3. WPA также не полностью защищен от злоумышленников, но обеспечивает гораздо большую защиту, чем WEP. Чтобы проникнуть в сеть с поддержкой WPA, злоумышленник должен попытаться взломать пароль с помощью программы для взлома паролей. Это считается дорогостоящим процессом с точки зрения времени, если пароль достаточно надежен.

Если злоумышленник может наблюдать (обнюхивать) за каждым, кто проходит аутентификацию в сети, у него достаточно возможностей для взлома паролей. Такие инструменты, как aircrack-ng ("[https://www.aircrack-ng.org/](https://www.aircrack-ng.org/)"), поддерживают взлом паролей Wi-Fi.

![image.png](image%20652.png)

### Enterprice Authentication

Корпоративные точки доступа также могут поддерживать аутентификацию клиентов на основе сертификатов, для чего требуется PKI ("Инфраструктура открытых ключей") или корпоративные учетные данные за счет интеграции с централизованной службой аутентификации.

У этого есть некоторые преимущества, особенно концепция управления ключами. В сети PSK основной проблемой является то, как распределяются, меняются местами и аннулируются пароли.

Хотя корпоративная аутентификация обеспечивает более эффективное управление безопасностью ключей, она также требует более сложной инфраструктуры и открывает другие возможности для злоумышленников.

## Cyber Security Penetration Testing

[Cyber Security Penetration Testing](https://www.google.com/search?q=Cyber+Security+Penetration+Testing&client=opera&hs=kFS&sca_esv=b338e4d9bf6df8e5&sxsrf=AE3TifPBZgYpRuh0Rw_PfzwE9avYJyMwHg%3A1765464657404&ei=Udo6ac2xGMumwPAP7Mbi8AI&ved=2ahUKEwjFmq-w5LWRAxUcNxAIHXO9AbsQgK4QegQIARAB&uact=5&oq=%D1%80%D0%B0%D1%81%D1%81%D0%BA%D0%B0%D0%B6%D0%B8+%D0%BC%D0%BD%D0%B5+%D0%BE%D0%B1+%D1%8D%D1%82%D0%BE%D0%BC+Cyber+Security+Penetration+Testing&gs_lp=Egxnd3Mtd2l6LXNlcnAiSNGA0LDRgdGB0LrQsNC20Lgg0LzQvdC1INC-0LEg0Y3RgtC-0LwgQ3liZXIgU2VjdXJpdHkgUGVuZXRyYXRpb24gVGVzdGluZzIFECEYoAEyBRAhGKABMgUQIRigAUilGFA3WP8CcAF4AJABAJgBmwGgAfEBqgEDMS4xuAEDyAEA-AEB-AECmAIDoAKDAsICBxAAGLADGB7CAgsQABiABBiwAxiiBMICBhAAGBYYHsICCBAAGIAEGKIEmAMAiAYBkAYIkgcDMi4xoAfgCrIHAzEuMbgH_QHCBwUwLjEuMsgHC4AIAA&sclient=gws-wiz-serp&mstk=AUtExfAQ_GTwep2w-qe2BqGMrzUTYz4Pl3btfCyv-fUFSQncLRmuODhR0VoRN9ZNvjnBWA6UceoMdhnY_Lj-LQ_LMLZxBv0X0YhJwu3f_QpLN26IqrjOwJ-sf2iNlpix8gNs9-Q7eb_N6rwfZB1K3iYFsB67ogB-avpJqigQj_h6MsxIQJ-TZ9W878gGcgvVmuZS3UAfNBcnutqmH1D8rhOdiuHsC6G66g6G4MZpBHdVjn1bAiVJZ1nkWxvuwS7WG6thhoJ9xaFTjAMMovRrBzcpiGpy-dJq8uQW082_9H0ofgaMhw&csui=3) (пентест) — это контролируемая имитация хакерской атаки на информационную систему компании с целью найти и использовать ее слабые места (уязвимости) еще до того, как это сделают злоумышленники, позволяя оценить реальный уровень защиты, потенциальный ущерб и разработать рекомендации по усилению безопасности.

Разница в том, что фишинг — это общая «удочка» для кражи данных, чаще через поддельные письма и сайты (e-mail + phishing), а вишинг — это его разновидность, использующая голосовые звонки (voice + phishing) для обмана, чтобы получить конфиденциальную информацию по телефону, представляясь сотрудниками банков или служб безопасности. Если фишинг — это email/сайт, то вишинг — это телефонный разговор, а смишинг — это SMS-сообщения. 

Типы атак на пароли: К числу наиболее распространенных типов атак на пароль относятся **взлом паролей, распыление паролей, атаки с перебором по словарю, подстановка учетных данных, атаки с подбором в радужных таблицах и методом подбора**.