# 14. Views

Категория: SQL Databases
Статус: Готово

### Views

Представления (Views)  - это именованный запрос, хранящийся в БД. Postgres выполняет запрос, определяющий представление, каждый раз, когда к представлению обращаются. 

Представление можно создать на основе одной или нескольких таблицах, или других представлений. 

![image.png](image%20373.png)

![image.png](image%20374.png)

![image.png](image%20375.png)

![image.png](image%20376.png)

Использование views:

- **Упрощение сложных запросов**: Можно сохранить сложный `SELECT` запрос, объединяющий данные из нескольких таблиц, и обращаться к нему как к обычной таблице.
- **Безопасность данных**: View позволяет предоставить пользователям доступ только к определённой части данных (например, к определённым столбцам или строкам), скрывая остальную информацию от неавторизованных пользователей.

### Material Views

Материализованные представления используют систему правил, аналогично представлениям, но сохраняют результаты в табличной форме. В отличие от представлений, материализованное представление хранит не только запрос, но и его результаты.

Разница между материализованным представлением и таблицей заключается в том, что материализованное представление не может быть обновлено напрямую. Его можно обновить с помощью оператора [REFRESH MATERIALIZED VIEW](https://www.postgresql.org/docs/16/sql-refreshmaterializedview.html).
Хотя доступ к данным, хранящимся в материализованном представлении, часто происходит намного быстрее, чем доступ к базовым таблицам напрямую или через обычное представление, данные могут быть не всегда актуальны. Материализованные представления можно использовать, когда некоторое устаревание данных вполне приемлемо.

![image.png](image%20377.png)

### **Сравнение представлений и материализованных представлений**

- Представление сохраняет только определяющий его запрос. Материализованное представление хранит определяющий запрос и его результат.
- Каждый раз при обращении к обыкновенному представлению выполняется его определяющий запрос. При обращении к материализованному представлению оно возвращает ранее сохраненный результат. Материализованное представление может возвращать устаревшие данные, если были изменены его базовые таблицы или представления. Необходимо выполнить оператор `REFRESH MATERIALIZED VIEW`, чтобы обновить материализованное представление.
- Материализованное представление часто возвращает результат намного быстрее, чем если получать данные напрямую из базовых таблиц или через обыкновенное представление.